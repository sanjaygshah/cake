<html>
   <head>
      <!-- not working with latest bootstrap and juery-->
      <title>Just-Cake</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="css/bootstrap.min.css">
      <script src="js/jquery-2.2.3.min.js"></script>
      <script type='text/javascript' src="js/bootstrap.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
      <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-storage.js"></script>
      <!-----firebase----->
      <script src="app.js"></script>
      <!--script src="index.js"></script-->
      <style>
         .badge-notify{
         background:red;
         position:relative;
         top: -20px;
         right: 10px;
         }
         .btn{
         margin-right: 10px;
         }
         .my-cart-icon-affix {
         position: fixed;
         z-index: 999;
         }
         .container.custom-container {
         padding: 0 50px;
         }
      </style>
   </head>
   <body class="container">
      <div class="page-header">
         <h1>
            Just Cake
            <div style="float: right; cursor: pointer;">
               <span class="glyphicon glyphicon-shopping-cart my-cart-icon"><span class="badge badge-notify my-cart-badge"></span></span>
            </div>
         </h1>
      </div>
      <!------nav------>
      <nav class="navbar navbar-inverse">
         <div class="container-fluid">
            <div class="navbar-header">
               <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span> 
               </button>
               <!--a class="navbar-brand" href="#">WebSiteName</a-->
            </div>
            <div class="collapse navbar-collapse" id="myNavbar">
               <ul class="nav navbar-nav">
                  <!--li id="m0" class="active"><a  href="index2.html">Home</a></li-->
                  <li id="m1" ><a href="#">Cakes</a></li>
                  <!--li id="m2"><a href="#">Accessory</a></li>
                     <li id="m3"><a href="#">Combo Pack (Cake+Accessory)</a></li> 
                     <li id="m4"><a href="#">Accessory Pack</a></li--> 
                  <li> <button class="btn btn-primary filter-button" style="width: 100%;" data-filter="all">All</button></li>
                  <li><button class="btn btn-default filter-button"  style="width: 100%;data-filter="Cake">Cake</button></li>
                  <li> <button class="btn btn-default filter-button" style="width: 100%;data-filter="Accessory">Accessory</button></li>
                  <li> <button class="btn btn-default filter-button" style="width: 100%; data-filter="Pack">Accessory Pack</button></li>
               </ul>
               <ul class="nav navbar-nav navbar-right">
                  <li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
                  <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
               </ul>
            </div>
         </div>
      </nav>
      <!------nav------>
      <div id="myCarousel" class="carousel slide" data-ride="carousel">
         <!-- Indicators -->
         <ol class="carousel-indicators">
            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
            <li data-target="#myCarousel" data-slide-to="1"></li>
            <li data-target="#myCarousel" data-slide-to="2"></li>
         </ol>
         <!-- Wrapper for slides -->
         <div id="my-store-17431012"></div>
         <!---- dfdsfsdfsd-->
         <div class="carousel-inner">
            <div class="item active">
               <img src="images/coau1.jpg" alt="Los Angeles">
            </div>
            <div class="item">
               <img src="images/coau2.jpg" alt="Chicago">
            </div>
            <div class="item">
               <img src="images/coau3.jpg" alt="New York">
            </div>
         </div>
         <!-- Left and right controls -->
         <a class="left carousel-control" href="#myCarousel" data-slide="prev">
         <span class="glyphicon glyphicon-chevron-left"></span>
         <span class="sr-only">Previous</span>
         </a>
         <a class="right carousel-control" href="#myCarousel" data-slide="next">
         <span class="glyphicon glyphicon-chevron-right"></span>
         <span class="sr-only">Next</span>
         </a>
      </div>
      <!--button type="addNewProduct" name="addNewProduct" id="addNewProduct">Add New Product</button-->
      <br>
      <div class="mx-auto">
         <div class="col-md-4 text-center filter cake">
            <img src="images/raw1.jpg" width="100%" height="150px">
         </div>
         <div class="col-md-4 text-center filter Accessory">
            <img src="images/raw2.jpg" width="100%" height="150px">
         </div>
         <div class="col-md-4 text-center filter combo">
            <img src="images/raw3.jpg" width="100%" height="150px">
         </div>
         <!--        <div class="col-md-3 text-center filter pack">
            <img src="images/img_4.png" width="150px" height="150px">
            <br>
            product 4 - <strong>$40</strong>
            <br>
            <button class="btn btn-danger my-cart-btn" data-id="4" data-name="product 4" data-summary="summary 4" data-price="40" data-quantity="1" data-image="images/img_4.png">Add to Cart</button>
            <a href="#" class="btn btn-info">Details</a>
            </div>
            -->
         <!--div>
            <button class="btn btn-primary filter-button" style="width: 20%;" data-filter="all">All</button>
            <button class="btn btn-default filter-button" style="width: 20%;" data-filter="Cake">Cake</button>
            <button class="btn btn-default filter-button" style="width: 20%;" data-filter="graphic">Accessory</button>
            <button class="btn btn-default filter-button" style="width: 20%;" data-filter="sanjay">Accessory Pack</button>
            </div-->
         <h2>Products</h2>
         <div id="dd" class="row"> </div>
      </div>
      <
      <!-- Modal 1 product details -->
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
         <div class="modal-dialog" role="document">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="exampleModalLabel">New message</h4>
               </div>
               <div class="modal-body">
                  <p></p>
                  <h5></h5>
               </div>
               <div class="modal-footer">
                  available in 500gm, 1 Kg, 1.5 Kg and 2 Kg.
                  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                  <!--button type="button" class="btn btn-primary">Goto cart</button-->
               </div>
            </div>
         </div>
      </div>
      <!-- Modal 2 collecting personal details -->
      <div class="modal fade" id="myModal" role="dialog">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Personal Details</h4>
               </div>
               <div class="modal-body">
                  <div class="form-group">
                     <p>Message on cake <textarea class="form-control"  pattern="{100}" rows="3" id="msg"></textarea></p>
                     <p>Mobile (Ten Digit) <textarea class="form-control"  pattern="{100}" rows="1" id="phone" pattern="[0-9]{10}" required ></textarea></p>
                     <!--p>Mobile(ten digit): <input type="number" id="phone" name="phone" pattern="[0-9]{10}" required><br><br>Delivery on<input type="date" name="dday"></p-->
                     <label for="comment">Address:</label>
                     <textarea class="form-control" rows="5" id="Address"></textarea>
                  </div>
               </div>
               <div class="modal-footer">
                  <button type="button" onclick="close1()" >Pay</button>
                  <p> Pay Rs.100 by clicking as booking amount. Remaining will be collected during delivery</p>
               </div>
            </div>
         </div>
      </div>
      <!--   Modal2 -->
      <!-- Modal 3 for select weight and flavour-->
      <div class="modal fade" id="myModal2" role="dialog">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Please Select</h4>
               </div>
               <div class="modal-body">
                  <p id='description'>details</p>
                
                  <div id="wt_opt">sss</div>
                  <h4 id="price">1000</h4>
                  <select id="mySelect1" >
                  </select>
                  
                  <select id="mySelect2">     // onchange="sel_shape()">
                    
                  </select>
                  <div class="form-group">
                  </div>
               </div>
               <div id="footer" class="modal-footer">
                  <button class="btn btn-success btn-xs my-cart-btn"  data-id=a.id data-name="500gm 123456 464 54646 446 46464 64 " data-summary="smmery" data-price="100" data-quantity="1" data-image="">Add to Cart and Keep shopping</button>
                  <!--button type="button" onclick="changeattr()" >Close</button-->
                
               </div>
            </div>
         </div>
      </div>
      <!--   Modal3 over -->
      <script type="text/javascript">
         var value="cake";
         var fin_ord="empty"
         $(document).ready(function(){
   $("#mySelect1").change(function() {
          
                 var x = document.getElementById("mySelect1").value;
                window.price_f=window.price1*x
                document.getElementById("price").innerHTML ='Rs.-'+window.price_f;
         });

      $("#mySelect2").change(function() {
          
                 var xx = document.getElementById("mySelect2").value;
                window.flavour=xx
              
                      });








         $("#m1").click(function() {
           window.value="cake";
         filt();
         });
         $("#m2").click(function() {
         window.value="Accessory";
         filt();
         }); 
             $("#m3").click(function() {
          window.value="Combo";
         filt();
         }); 
                 $("#m4").click(function() {
         window.value="pack";
         filt();
         }); 
         $(".filter-button").click(function(){
             var value = $(this).attr('data-filter');
         //var value=window.value
           
             if(value == "all")
             {
                 //$('.filter').removeClass('hidden');
                 $('.filter').show('1000');
             }
             else
             {
         //            $('.filter[filter-item="'+value+'"]').removeClass('hidden');
         //            $(".filter").not('.filter[filter-item="'+value+'"]').addClass('hidden');
                 $(".filter").not('.'+value).hide('3000');
                 $('.filter').filter('.'+value).show('3000');
             }
             if($('.navbar-toggle').css('display') !='none'){
                 $('.navbar-toggle').trigger( "click" );
             }
         });
         function filt(){
         
         var value=window.value
         if($('.navbar-toggle').css('display') !='none'){
                 $('.navbar-toggle').trigger( "click" );
             }
           // navbar hide?
            if(value == "all")
             {
        
                 //$('.filter').removeClass('hidden');
                 $('.filter').show('1000');
             }
             else
             {
         
                $('.filter[filter-item="'+value+'"]').removeClass('hidden');
               $(".filter").not('.filter[filter-item="'+value+'"]').addClass('hidden');
                 $(".filter").not('.'+value).hide('3000');
                 $('.filter').filter('.'+value).show('3000');
             }
         }
         });
      </script>
      <script type='text/javascript' src="js/jquery.mycart.js"></script>
      <script type="text/javascript">
         $(function () {
            var value="cake";
           var goToCartIcon = function($addTocartBtn){
             var $cartIcon = $(".my-cart-icon");
             var $image = $('<img width="30px" height="30px" src="' + $addTocartBtn.data("image") + '"/>').css({"position": "fixed", "z-index": "999"});
             $addTocartBtn.prepend($image);
             var position = $cartIcon.position();
             $image.animate({
               top: position.top,
               left: position.left
             }, 500 , "linear", function() {
               $image.remove();
             });
           }
           $('.my-cart-btn').myCart({
             currencySymbol: '$',
             classCartIcon: 'my-cart-icon',
             classCartBadge: 'my-cart-badge',
             classProductQuantity: 'my-product-quantity',
             classProductRemove: 'my-product-remove',
             classCheckoutCart: 'my-cart-checkout',
             affixCartIcon: true,
             showCheckoutModal: true,
             numberOfDecimals: 2,
             cartItems: [
             ],
             clickOnAddToCart: function($addTocart){
               goToCartIcon($addTocart);
             },
             afterAddOnCart: function(products, totalPrice, totalQuantity) {
               console.log("afterAddOnCart", products, totalPrice, totalQuantity);
             },
             clickOnCartIcon: function($cartIcon, products, totalPrice, totalQuantity) {
               console.log("cart icon clicked", $cartIcon, products, totalPrice, totalQuantity);
             },
             checkoutCart: function(products, totalPrice, totalQuantity) {
               var checkoutString = "Total Price: " + totalPrice + "\nTotal Quantity: " + totalQuantity;
               checkoutString += "\n\n id \t name \t summary \t price \t quantity \t image path";
               $.each(products, function(){
                // checkoutString += ("\n " + this.id + " \t " + this.name + " \t " + this.summary + " \t " + this.price + " \t " + this.quantity + " \t " + this.image);
              // checkoutString += ("\n \n[" + this.id + "-" + this.name + "-" + this.summary + "-" + this.price + "-" + this.quantity + "]" );
                checkoutString += ("\n \n[" + this.id +  "]" );

               });
               //https://wa.me/+919974021397/?text="hi"
                  $("#myModal").modal('show');
                 
                   window.fin_ord=checkoutString
              // window.open('https://wa.me/+919974021397/?text="'+checkoutString +'"', "_top");
               console.log("checking out", products, totalPrice, totalQuantity);
             },
             getDiscountPrice: function(products, totalPrice, totalQuantity) {
               console.log("calculating discount", products, totalPrice, totalQuantity);
               return totalPrice * 0.0;
             }
           });
           $("#addNewProduct").click(function(event) {
             var currentElementNo = $(".row").children().length + 1;
             $(".row").append('<div class="col-md-3 text-center"><img src="images/img_empty.png" width="150px" height="150px"><br>product ' + currentElementNo + ' - <strong>$' + currentElementNo + '</strong><br><button class="btn btn-danger my-cart-btn" data-id="' + currentElementNo + '" data-name="product ' + currentElementNo + '" data-summary="summary ' + currentElementNo + '" data-price="' + currentElementNo + '" data-quantity="1" data-image="images/img_empty.png">Add to Cart</button><a href="#" class="btn btn-info">Details</a></div>')
           });
         });
         function close1(){
           n=$("#phone").val().length;
           if (n==10){
            $("#myModal").modal('hide');
           window.fin_ord ="Mobie No"+$("#phone").val()+"Detail-" +window.fin_ord;
           order1();
         }else {
           alert("Please add proper mobile no");
         }
       
         }
         function order1(){
         window.open("https://p-y.tm/PWB-cdq");
          var db = firebase.firestore();
                            var citiesRef = db.collection("order");
                             return citiesRef.add({           // for adding new data (which is added with new raw)        
                                                     detail:  window.fin_ord ,
                                                     Tstamp:firebase.firestore.FieldValue.serverTimestamp()
                                           }).then(function(docRef) {
                                console.log("Document written with ID: ", docRef.id);
                               // location.reload();
                            })
                            .catch(function(error) {
                                console.error("Error adding document: ", error)
                       });
                            
         }
         function changeattr(){
         // alert('change data attr');
         //document.getElementsByTagName("H1")[1].setAttribute("data-n", "jay");
         }
      </script>
      <script type="text/javascript">
         $('#exampleModal').on('show.bs.modal', function (event) {
         var button = $(event.relatedTarget) // Button that triggered the modal
         var recipient = button.data('whatever') // Extract info from data-* attributes
         // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
         // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
          var recipient2 = button.data('remark')
            var recipient3 = button.data('price1')
         var modal = $(this)
         modal.find('.modal-title').text( recipient)
         modal.find('.modal-body p').text(recipient2)
         modal.find('.modal-body h5').text('Rs.-'+recipient3)
         })

         $('#myModal2').on('show.bs.modal', function (event) {
         $("#mySelect1").empty();
           $("#mySelect2").empty();
          
         var button = $(event.relatedTarget) // Button that triggered the modal
          window.flavour=1;
           window.price_f=button.data('price1');
           
          // adding radio options for weight
                     var str=button.data('wt');
                     var wt_array = str.split(",");        
                     var i=1
                             $.each(wt_array,function(i,ii){
                                        $("#mySelect1").append(
                                           $('<option />', {
                                              'text':  ii,
                                              value: i+1,
                                              id:'wt' +(i+1)                       
                                           })
                                     ); 
                             });

          // adding radio options for lavour
                    var str=button.data('fl')
                    var fl_array=str.split(",")
                    i=1
                    $.each(fl_array,function(ind,flav){
                        $("#mySelect2").append(
                          $("<option/>",{
                            'text':flav,
                            value:flav
                          })
                          );
                    });
                    
                    // appending child button in footer
                      $("#footer").empty();
                    $("#footer").append($("<Button>",{
                      'text':"Add to cart",
                      'data-id':button.data('id'),
                      'class':"btn btn-success btn-xs my-cart-btn",
                      'data-name':button.data('name'),
                      'data-price1':button.data('price1'),
                      'data-quantity':"1",
                      'data-image':"",
                      'data-pdetails':button.data('pdetails')


                        })
                      )
         var pname = button.data('name') 
         window.prd=pname
         var description = button.data('pdetails')
         var pprice1 = button.data('price1')
         window.price1=pprice1
         window.price_f=window.price1
         window.shape='a'
         var modal = $(this)
         modal.find('.modal-title').text( pname)
         modal.find('.modal-body p').text(description)
          modal.find('.modal-body h4').text('Rs.-'+price1)
        
                   })
         
         function sel_shape(){
         var x = document.getElementById("mySelect2").value;
         window.shape=x
         //todo-add to cart on popup -attribut set 
         // alert(x);
         }
       
      </script>
   </body>
</html>